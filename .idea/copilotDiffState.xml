<?xml version="1.0" encoding="UTF-8"?>
<project version="4">
  <component name="CopilotDiffPersistence">
    <option name="pendingDiffs">
      <map>
        <entry key="$PROJECT_DIR$/.gitignore">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/.gitignore" />
              <option name="updatedContent" value="HELP.md&#10;target/&#10;!.mvn/wrapper/maven-wrapper.jar&#10;!**/src/main/**/target/&#10;!**/src/test/**/target/&#10;&#10;### STS ###&#10;.apt_generated&#10;.classpath&#10;.factorypath&#10;.project&#10;.settings&#10;.springBeans&#10;.sts4-cache&#10;&#10;### IntelliJ IDEA ###&#10;.idea&#10;*.iws&#10;*.iml&#10;*.ipr&#10;&#10;### NetBeans ###&#10;/nbproject/private/&#10;/nbbuild/&#10;/dist/&#10;/nbdist/&#10;/.nb-gradle/&#10;build/&#10;!**/src/main/**/build/&#10;!**/src/test/**/build/&#10;&#10;### VS Code ###&#10;.vscode/" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/src/main/java/com/alejandro/microservices/api_wallet/wallet/config/package-info.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/src/main/java/com/alejandro/microservices/api_wallet/wallet/config/package-info.java" />
              <option name="originalContent" value="package com.alejandro.microservices.api_wallet.wallet.config;&#10;&#10;" />
              <option name="updatedContent" value="package com.alejandro.microservices.api_wallet.wallet.config;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/src/main/java/com/alejandro/microservices/api_wallet/wallet/controller/package-info.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/src/main/java/com/alejandro/microservices/api_wallet/wallet/controller/package-info.java" />
              <option name="originalContent" value="package com.alejandro.microservices.api_wallet.wallet.controller;&#10;&#10;" />
              <option name="updatedContent" value="package com.alejandro.microservices.api_wallet.wallet.controller;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/src/main/java/com/alejandro/microservices/api_wallet/wallet/dto/package-info.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/src/main/java/com/alejandro/microservices/api_wallet/wallet/dto/package-info.java" />
              <option name="originalContent" value="package com.alejandro.microservices.api_wallet.wallet.dto;&#10;&#10;" />
              <option name="updatedContent" value="package com.alejandro.microservices.api_wallet.wallet.dto;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/src/main/java/com/alejandro/microservices/api_wallet/wallet/entity/Role.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/src/main/java/com/alejandro/microservices/api_wallet/wallet/entity/Role.java" />
              <option name="originalContent" value="package com.alejandro.microservices.api_wallet.wallet.entity;&#10;&#10;import jakarta.persistence.*;&#10;import lombok.*;&#10;&#10;import java.util.HashSet;&#10;import java.util.Set;&#10;&#10;@Entity&#10;@Table(name = &quot;roles&quot;)&#10;@Getter&#10;@Setter&#10;@ToString(exclude = &quot;users&quot;)&#10;@EqualsAndHashCode(exclude = &quot;users&quot;)&#10;@NoArgsConstructor&#10;@AllArgsConstructor&#10;public class Role {&#10;    @Id&#10;    @GeneratedValue(strategy = GenerationType.IDENTITY)&#10;    private Long id;&#10;&#10;    @Enumerated(EnumType.STRING)&#10;    @Column(unique = true, nullable = false)&#10;    private RoleName name;&#10;&#10;    @ManyToMany(mappedBy = &quot;roles&quot;)&#10;    private Set&lt;User&gt; users = new HashSet&lt;&gt;();&#10;&#10;    public enum RoleName {&#10;        ROLE_USER,&#10;        ROLE_ADMIN&#10;    }&#10;}&#10;" />
              <option name="updatedContent" value="package com.alejandro.microservices.api_wallet.wallet.entity;&#10;&#10;import jakarta.persistence.*;&#10;import lombok.*;&#10;&#10;import java.util.HashSet;&#10;import java.util.Set;&#10;&#10;@Entity&#10;@Table(name = &quot;roles&quot;)&#10;@Getter&#10;@Setter&#10;@ToString(exclude = &quot;users&quot;)&#10;@EqualsAndHashCode(exclude = &quot;users&quot;)&#10;@NoArgsConstructor&#10;public class Role {&#10;    @Id&#10;    @GeneratedValue(strategy = GenerationType.IDENTITY)&#10;    private Long id;&#10;&#10;    @Enumerated(EnumType.STRING)&#10;    @Column(unique = true, nullable = false)&#10;    private RoleName name;&#10;&#10;    @ManyToMany(mappedBy = &quot;roles&quot;)&#10;    private Set&lt;User&gt; users = new HashSet&lt;&gt;();&#10;&#10;    public Role(RoleName name) {&#10;        this.name = name;&#10;    }&#10;&#10;    public enum RoleName {&#10;        ROLE_USER,&#10;        ROLE_ADMIN&#10;    }&#10;}" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/src/main/java/com/alejandro/microservices/api_wallet/wallet/entity/Transaction.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/src/main/java/com/alejandro/microservices/api_wallet/wallet/entity/Transaction.java" />
              <option name="updatedContent" value="package com.alejandro.microservices.api_wallet.wallet.entity;&#10;&#10;import jakarta.persistence.*;&#10;import lombok.*;&#10;import java.math.BigDecimal;&#10;import java.time.Instant;&#10;&#10;@Entity&#10;@Table(name = &quot;transactions&quot;)&#10;@Getter&#10;@Setter&#10;@ToString(exclude = {&quot;walletFrom&quot;, &quot;walletTo&quot;})&#10;@EqualsAndHashCode(exclude = {&quot;walletFrom&quot;, &quot;walletTo&quot;})&#10;@NoArgsConstructor&#10;public class Transaction {&#10;    @Id @GeneratedValue(strategy = GenerationType.IDENTITY)&#10;    private Long id;&#10;&#10;    @ManyToOne(fetch = FetchType.LAZY)&#10;    @JoinColumn(name = &quot;wallet_from&quot;)&#10;    private Wallet walletFrom; // nullable for DEPOSIT&#10;&#10;    @ManyToOne(fetch = FetchType.LAZY)&#10;    @JoinColumn(name = &quot;wallet_to&quot;)&#10;    private Wallet walletTo;   // nullable for WITHDRAW&#10;&#10;    @Column(nullable = false)&#10;    private BigDecimal amount;&#10;&#10;    @Enumerated(EnumType.STRING)&#10;    @Column(nullable = false)&#10;    private TransactionType type;&#10;&#10;    @Enumerated(EnumType.STRING)&#10;    @Column(nullable = false)&#10;    private TransactionStatus status;&#10;&#10;    private Instant createdAt = Instant.now();&#10;&#10;    private String description;&#10;&#10;    @Column(unique = true)&#10;    private String clientTransferId; // optional for idempotency&#10;&#10;    public enum TransactionType {&#10;        DEPOSIT, WITHDRAWAL, TRANSFER&#10;    }&#10;&#10;    public enum TransactionStatus {&#10;        PENDING, SUCCESS, FAILED&#10;    }&#10;&#10;    public Transaction(Wallet walletFrom, Wallet walletTo, BigDecimal amount, TransactionType type) {&#10;        this.walletFrom = walletFrom;&#10;        this.walletTo = walletTo;&#10;        this.amount = amount;&#10;        this.type = type;&#10;        this.status = TransactionStatus.PENDING;&#10;    }&#10;}" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/src/main/java/com/alejandro/microservices/api_wallet/wallet/entity/User.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/src/main/java/com/alejandro/microservices/api_wallet/wallet/entity/User.java" />
              <option name="originalContent" value="package com.alejandro.microservices.api_wallet.wallet.entity;&#10;&#10;import jakarta.persistence.*;&#10;import lombok.*;&#10;import java.time.Instant;&#10;import java.util.HashSet;&#10;import java.util.Set;&#10;&#10;@Entity&#10;@Table(name = &quot;users&quot;)&#10;@Getter&#10;@Setter&#10;@ToString(exclude = &quot;roles&quot;)&#10;@EqualsAndHashCode(exclude = &quot;roles&quot;)&#10;@NoArgsConstructor&#10;@AllArgsConstructor&#10;public class User {&#10;    @Id @GeneratedValue(strategy = GenerationType.IDENTITY)&#10;    private Long id;&#10;&#10;    private String fullName;&#10;&#10;    @Column(unique = true, nullable = false)&#10;    private String email;&#10;&#10;    @Column(nullable = false)&#10;    private String password; // hashed&#10;&#10;    @ManyToMany(fetch = FetchType.EAGER)&#10;    @JoinTable(name = &quot;user_roles&quot;,&#10;        joinColumns = @JoinColumn(name = &quot;user_id&quot;),&#10;        inverseJoinColumns = @JoinColumn(name = &quot;role_id&quot;))&#10;    private Set&lt;Role&gt; roles = new HashSet&lt;&gt;();&#10;&#10;    private Instant createdAt = Instant.now();&#10;}&#10;" />
              <option name="updatedContent" value="package com.alejandro.microservices.api_wallet.wallet.entity;&#10;&#10;import jakarta.persistence.*;&#10;import lombok.*;&#10;import java.time.Instant;&#10;import java.util.HashSet;&#10;import java.util.Set;&#10;&#10;@Entity&#10;@Table(name = &quot;users&quot;)&#10;@Getter&#10;@Setter&#10;@ToString(exclude = &quot;roles&quot;)&#10;@EqualsAndHashCode(exclude = &quot;roles&quot;)&#10;@NoArgsConstructor&#10;public class User {&#10;    @Id @GeneratedValue(strategy = GenerationType.IDENTITY)&#10;    private Long id;&#10;&#10;    private String fullName;&#10;&#10;    @Column(unique = true, nullable = false)&#10;    private String email;&#10;&#10;    @Column(nullable = false)&#10;    private String password; // hashed&#10;&#10;    @ManyToMany(fetch = FetchType.EAGER, cascade = CascadeType.ALL)&#10;    @JoinTable(name = &quot;user_roles&quot;,&#10;            joinColumns = @JoinColumn(name = &quot;user_id&quot;),&#10;            inverseJoinColumns = @JoinColumn(name = &quot;role_id&quot;))&#10;    private Set&lt;Role&gt; roles = new HashSet&lt;&gt;();&#10;&#10;    private Instant createdAt = Instant.now();&#10;&#10;    public User(String fullName, String email, String password) {&#10;        this.fullName = fullName;&#10;        this.email = email;&#10;        this.password = password;&#10;    }&#10;&#10;    public void addRole(Role role) {&#10;        roles.add(role);&#10;        role.getUsers().add(this);&#10;    }&#10;&#10;    public void removeRole(Role role) {&#10;        roles.remove(role);&#10;        role.getUsers().remove(this);&#10;    }&#10;}" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/src/main/java/com/alejandro/microservices/api_wallet/wallet/entity/Wallet.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/src/main/java/com/alejandro/microservices/api_wallet/wallet/entity/Wallet.java" />
              <option name="updatedContent" value="package com.alejandro.microservices.api_wallet.wallet.entity;&#10;&#10;import jakarta.persistence.*;&#10;import lombok.*;&#10;import java.math.BigDecimal;&#10;import java.time.Instant;&#10;&#10;@Entity&#10;@Table(name = &quot;wallets&quot;)&#10;@Getter&#10;@Setter&#10;@ToString(exclude = &quot;user&quot;)&#10;@EqualsAndHashCode(exclude = &quot;user&quot;)&#10;@NoArgsConstructor&#10;public class Wallet {&#10;    @Id @GeneratedValue(strategy = GenerationType.IDENTITY)&#10;    private Long id;&#10;&#10;    @ManyToOne(fetch = FetchType.LAZY)&#10;    @JoinColumn(name = &quot;user_id&quot;, nullable = false)&#10;    private User user;&#10;&#10;    @Column(nullable = false)&#10;    private BigDecimal balance = BigDecimal.ZERO;&#10;&#10;    private String currency = &quot;COP&quot;;&#10;&#10;    private Instant createdAt = Instant.now();&#10;&#10;    public Wallet(User user, String currency) {&#10;        this.user = user;&#10;        this.currency = currency;&#10;    }&#10;}" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/src/main/java/com/alejandro/microservices/api_wallet/wallet/repository/RoleRepository.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/src/main/java/com/alejandro/microservices/api_wallet/wallet/repository/RoleRepository.java" />
              <option name="updatedContent" value="package com.alejandro.microservices.api_wallet.wallet.repository;&#10;&#10;import com.alejandro.microservices.api_wallet.wallet.entity.Role;&#10;import org.springframework.data.jpa.repository.JpaRepository;&#10;import java.util.Optional;&#10;&#10;public interface RoleRepository extends JpaRepository&lt;Role, Long&gt; {&#10;    Optional&lt;Role&gt; findByName(Role.RoleName name);&#10;}" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/src/main/java/com/alejandro/microservices/api_wallet/wallet/repository/TransactionRepository.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/src/main/java/com/alejandro/microservices/api_wallet/wallet/repository/TransactionRepository.java" />
              <option name="updatedContent" value="package com.alejandro.microservices.api_wallet.wallet.repository;&#10;&#10;import com.alejandro.microservices.api_wallet.wallet.entity.Transaction;&#10;import org.springframework.data.domain.Page;&#10;import org.springframework.data.domain.Pageable;&#10;import org.springframework.data.jpa.repository.JpaRepository;&#10;&#10;public interface TransactionRepository extends JpaRepository&lt;Transaction, Long&gt; {&#10;    Page&lt;Transaction&gt; findByWalletFromIdOrWalletToId(Long fromId, Long toId, Pageable pageable);&#10;}" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/src/main/java/com/alejandro/microservices/api_wallet/wallet/repository/UserRepository.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/src/main/java/com/alejandro/microservices/api_wallet/wallet/repository/UserRepository.java" />
              <option name="updatedContent" value="package com.alejandro.microservices.api_wallet.wallet.repository;&#10;&#10;import com.alejandro.microservices.api_wallet.wallet.entity.User;&#10;import org.springframework.data.jpa.repository.JpaRepository;&#10;import java.util.Optional;&#10;&#10;public interface UserRepository extends JpaRepository&lt;User, Long&gt; {&#10;    Optional&lt;User&gt; findByEmail(String email);&#10;    boolean existsByEmail(String email);&#10;}" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/src/main/java/com/alejandro/microservices/api_wallet/wallet/repository/WalletRepository.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/src/main/java/com/alejandro/microservices/api_wallet/wallet/repository/WalletRepository.java" />
              <option name="originalContent" value="&#10;@Repository&#10;public interface WalletRepository extends JpaRepository&lt;Wallet, Long&gt; {&#10;    @Lock(LockModeType.PESSIMISTIC_WRITE)&#10;    @Query(&quot;select w from Wallet w where w.id = :id&quot;)&#10;    Optional&lt;Wallet&gt; findByIdForUpdate(@Param(&quot;id&quot;) Long id);&#10;&#10;    List&lt;Wallet&gt; findByUserId(Long userId);&#10;}" />
              <option name="updatedContent" value="package com.alejandro.microservices.api_wallet.wallet.repository;&#10;&#10;import com.alejandro.microservices.api_wallet.wallet.entity.Wallet;&#10;import org.springframework.data.jpa.repository.*;&#10;import org.springframework.data.repository.query.Param;&#10;import org.springframework.stereotype.Repository;&#10;import jakarta.persistence.LockModeType;&#10;import java.util.Optional;&#10;import java.util.List;&#10;&#10;@Repository&#10;public interface WalletRepository extends JpaRepository&lt;Wallet, Long&gt; {&#10;    @Lock(LockModeType.PESSIMISTIC_WRITE)&#10;    @Query(&quot;select w from Wallet w where w.id = :id&quot;)&#10;    Optional&lt;Wallet&gt; findByIdForUpdate(@Param(&quot;id&quot;) Long id);&#10;&#10;    List&lt;Wallet&gt; findByUserId(Long userId);&#10;}" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/src/main/java/com/example/wallet/config/package-info.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/src/main/java/com/example/wallet/config/package-info.java" />
              <option name="updatedContent" value="package com.example.wallet.config;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/src/main/java/com/example/wallet/controller/package-info.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/src/main/java/com/example/wallet/controller/package-info.java" />
              <option name="updatedContent" value="package com.example.wallet.controller;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/src/main/java/com/example/wallet/dto/package-info.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/src/main/java/com/example/wallet/dto/package-info.java" />
              <option name="updatedContent" value="package com.example.wallet.dto;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/src/main/java/com/example/wallet/entity/package-info.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/src/main/java/com/example/wallet/entity/package-info.java" />
              <option name="updatedContent" value="package com.example.wallet.entity;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/src/main/java/com/example/wallet/exception/package-info.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/src/main/java/com/example/wallet/exception/package-info.java" />
              <option name="updatedContent" value="package com.example.wallet.exception;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/src/main/java/com/example/wallet/repository/package-info.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/src/main/java/com/example/wallet/repository/package-info.java" />
              <option name="updatedContent" value="package com.example.wallet.repository;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/src/main/java/com/example/wallet/security/package-info.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/src/main/java/com/example/wallet/security/package-info.java" />
              <option name="updatedContent" value="package com.example.wallet.security;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/src/main/java/com/example/wallet/service/package-info.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/src/main/java/com/example/wallet/service/package-info.java" />
              <option name="updatedContent" value="package com.example.wallet.service;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/src/main/java/com/example/wallet/util/package-info.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/src/main/java/com/example/wallet/util/package-info.java" />
              <option name="updatedContent" value="package com.example.wallet.util;" />
            </PendingDiffInfo>
          </value>
        </entry>
      </map>
    </option>
  </component>
</project>